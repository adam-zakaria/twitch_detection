Testing 
/home/ubuntu/Code/twitch_detection/test/misc/download_and_process.py
with streams that we will rsync from local to gpu so we can test pipeline with actual detections. So far, we know the pipeline works in prod when streams are downloaded and no dks (because we tested with downloads of only 10s)

# Last run, for prod, 60 minutes

It seems a .mp4.part snuck in and caused issues...not sure what happened:

ubuntu@ip-172-31-46-149:~/Code/twitch_detection/test/production$ py main.py 
Starting job at 03_02_2025_23_10_17 ################################
Starting Twitch stream downloads
Downloading renegade's stream to twitch_streams/renegade...
Downloading formal's stream to twitch_streams/formal...
Downloading Luciid_TW's stream to twitch_streams/Luciid_TW...
Downloading itzthelastshot's stream to twitch_streams/itzthelastshot...
Downloading SpartanTheDogg's stream to twitch_streams/SpartanTheDogg...
Downloading SnakeBite's stream to twitch_streams/SnakeBite...
Downloading aPG's stream to twitch_streams/aPG...
Downloading Bound's stream to twitch_streams/Bound...
Downloading kuhlect's stream to twitch_streams/kuhlect...
Downloading druk84's stream to twitch_streams/druk84...
Downloading pzzznguin's stream to twitch_streams/pzzznguin...
Downloading cykul's stream to twitch_streams/cykul...
Downloading Tripppey's stream to twitch_streams/Tripppey...
Downloading royal2's stream to twitch_streams/royal2...
Downloading bubudubu's stream to twitch_streams/bubudubu...
Downloading mikwen's stream to twitch_streams/mikwen...
Downloading Ogre2's stream to twitch_streams/Ogre2...
Downloading HuNteR_Jjx's stream to twitch_streams/HuNteR_Jjx...
Downloading Alleesi's stream to twitch_streams/Alleesi...
Downloading Cruvu's stream to twitch_streams/Cruvu...
Subprocesses are in group with leader PID: 51615
To kill all download subprocesses (without killing the parent), run:
kill -2 -51615; sleep 2; kill -9 -51615
^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[C^[[CDaily task at 03_03_2025_00_10_18 ################################
* Sleeping *
* Waking *
Uploading twitch_streams to twitch_streams
Uploading: itzthelastshot/76bcc619db554fa099cf31c3da8f67bf.mp4
Uploading: itzthelastshot/76bcc619db554fa099cf31c3da8f67bf.temp.mp4
Uploading: formal/ebbb4016c46443c8a61da1a5d93b59b9.mp4
Uploading: formal/ebbb4016c46443c8a61da1a5d93b59b9.temp.mp4
Uploading: Bound/0de6e4d97a204960aa7b13098397131e.mp4
Uploading: Bound/0de6e4d97a204960aa7b13098397131e.temp.mp4
Starting gpu
üöÄ Checking instance state...
üîå Starting instance...
{
    "StartingInstances": [
        {
            "InstanceId": "i-02a34bba08ac27886",
            "CurrentState": {
                "Code": 0,
                "Name": "pending"
            },
            "PreviousState": {
                "Code": 80,
                "Name": "stopped"
            }
        }
    ]
}
‚è≥ Waiting for instance to reach 'running' state...
‚úÖ Instance is now running.
‚è≥ Waiting for instance status checks...
‚úÖ Instance is fully initialized.
üöÄ Running Python script on GPU instance...
Warning: Permanently added '52.54.193.44' (ED25519) to the list of known hosts.
Cloning into '/home/ubuntu/Code/twitch_detection'...
[mov,mp4,m4a,3gp,3g2,mj2 @ 0x5bb2c0063b80] moov atom not found
Downloading: Bound/0de6e4d97a204960aa7b13098397131e.mp4
Downloading: Bound/0de6e4d97a204960aa7b13098397131e.temp.mp4
Downloading: Bound/8c3d1fe2989c4317be0873d9aeaa3f52.mp4
Downloading: Bound/8c3d1fe2989c4317be0873d9aeaa3f52.temp.mp4
Downloading: Bound/a178aabdfac44ce3af4fa084dd8b6bbf.mp4
Downloading: Bound/d35fc1e938394b02be910a1fa4878a50.mp4
Downloading: Bound/da503814c0ec4b269717649bf80861d2.mp4.part
Downloading: Bound/e3ca4f77d3994cc98d964b1ec065c4a5.mp4
Downloading: Cruvu/e55237baefd1437596d77b3658a88244.mp4
Downloading: Cruvu/f39767cf7b6047bc832206380f5846dc.mp4
Downloading: Cruvu/f39767cf7b6047bc832206380f5846dc.temp.mp4
Downloading: HuNteR_Jjx/89a060488cad4cd0ae3fafc1d1260e76.mp4
Downloading: HuNteR_Jjx/89a060488cad4cd0ae3fafc1d1260e76.temp.mp4
Downloading: HuNteR_Jjx/f70a4cb51fff42c48cfe41ce71270862.mp4
Downloading: Luciid_TW/390454007d054be39686d0e52f73d671.mp4
Downloading: Luciid_TW/9118762afa4b47a296344273801f0584.mp4
Downloading: formal/0df3d5c0cb50428bb301aaab39ea7e10.mp4.part
Downloading: formal/47ba5041a46c4c6984106d653c74b45b.mp4
Downloading: formal/a2ebac357ae7480680ed82755ca67d3a.mp4
Downloading: formal/adc435b3c7344257bca9e66433996f29.mp4
Downloading: formal/ebbb4016c46443c8a61da1a5d93b59b9.mp4
Downloading: formal/ebbb4016c46443c8a61da1a5d93b59b9.temp.mp4
Downloading: formal/f7743fc746f84127aaaf83e9421f6b2a.mp4
Downloading: itzthelastshot/3e3f12b6c7fa4d2b871659e5ed7c0654.mp4.part
Downloading: itzthelastshot/5282b4b61cab4e82adeb4a710688ece5.mp4
Downloading: itzthelastshot/6388fab8a0544f57929e106c35ba9208.mp4
Downloading: itzthelastshot/70917df769fc4ca783e84f3aa13693ce.mp4
Downloading: itzthelastshot/76bcc619db554fa099cf31c3da8f67bf.mp4
Downloading: itzthelastshot/76bcc619db554fa099cf31c3da8f67bf.temp.mp4
Downloading: itzthelastshot/f70b12bc125b431f863c5375792913eb.mp4
Starting detect_timestamps...
Output folder: output/HuNteR_Jjx/03_03_2025_00_14_40/detect
detect_timestamps finished successfully.
In detect() no double kills detected for twitch_streams/HuNteR_Jjx/f70a4cb51fff42c48cfe41ce71270862.mp4, moving onto next video
Starting detect_timestamps...
Output folder: output/HuNteR_Jjx/03_03_2025_00_14_54/detect
detect_timestamps finished successfully.
In detect() no double kills detected for twitch_streams/HuNteR_Jjx/89a060488cad4cd0ae3fafc1d1260e76.mp4, moving onto next video
Starting detect_timestamps...
Error in detect_timestamps: Error: Cannot open video at path 'twitch_streams/HuNteR_Jjx/89a060488cad4cd0ae3fafc1d1260e76.temp.mp4'
Traceback (most recent call last):
  File "/home/ubuntu/Code/twitch_detection/test/production/gpu_process.py", line 232, in <module>
    detections = detect_timestamps(input_video_path, roi, detect_folder)
    ‚îÇ            ‚îÇ                 ‚îÇ                 ‚îÇ    ‚îî PosixPath('output/HuNteR_Jjx/03_03_2025_00_17_05/detect')
    ‚îÇ            ‚îÇ                 ‚îÇ                 ‚îî (529, 441, 266, 131)
    ‚îÇ            ‚îÇ                 ‚îî 'twitch_streams/HuNteR_Jjx/89a060488cad4cd0ae3fafc1d1260e76.temp.mp4'
    ‚îÇ            ‚îî <function log_calls.<locals>.wrapper at 0x7673bc4687c0>
    ‚îî None
  File "/home/ubuntu/Code/twitch_detection/test/production/gpu_process.py", line 25, in wrapper
    result = func(*args, **kwargs)
             ‚îÇ     ‚îÇ       ‚îî {}
             ‚îÇ     ‚îî ('twitch_streams/HuNteR_Jjx/89a060488cad4cd0ae3fafc1d1260e76.temp.mp4', (529, 441, 266, 131), PosixPath('output/HuNteR_Jjx/03_03...
             ‚îî <function detect_timestamps at 0x7673bc463f60>
  File "/home/ubuntu/Code/twitch_detection/test/production/gpu_process.py", line 51, in detect_timestamps
    for t, frame in utils.get_frames(input_video_path, timestamps=timestamps, yield_timestamps=True):
  File "/home/ubuntu/Code/utils/utils/utils.py", line 160, in get_frames
    raise ValueError(f"Error: Cannot open video at path '{video_path}'")
                                                          ‚îî 'twitch_streams/HuNteR_Jjx/89a060488cad4cd0ae3fafc1d1260e76.temp.mp4'
ValueError: Error: Cannot open video at path 'twitch_streams/HuNteR_Jjx/89a060488cad4cd0ae3fafc1d1260e76.temp.mp4'
üõë Shutting down instance...
‚úÖ Instance has been powered down.

üéØ All Done!
Removed twitch_streams folder.
Starting Twitch stream downloads
Downloading renegade's stream to twitch_streams/renegade...
Downloading formal's stream to twitch_streams/formal...
Downloading Luciid_TW's stream to twitch_streams/Luciid_TW...
Downloading itzthelastshot's stream to twitch_streams/itzthelastshot...
Downloading SpartanTheDogg's stream to twitch_streams/SpartanTheDogg...
Downloading SnakeBite's stream to twitch_streams/SnakeBite...
Downloading aPG's stream to twitch_streams/aPG...
Downloading Bound's stream to twitch_streams/Bound...
Downloading kuhlect's stream to twitch_streams/kuhlect...
Downloading druk84's stream to twitch_streams/druk84...
Downloading pzzznguin's stream to twitch_streams/pzzznguin...
Downloading cykul's stream to twitch_streams/cykul...
Downloading Tripppey's stream to twitch_streams/Tripppey...
Downloading royal2's stream to twitch_streams/royal2...
Downloading bubudubu's stream to twitch_streams/bubudubu...
Downloading mikwen's stream to twitch_streams/mikwen...
Downloading Ogre2's stream to twitch_streams/Ogre2...
Downloading HuNteR_Jjx's stream to twitch_streams/HuNteR_Jjx...
Downloading Alleesi's stream to twitch_streams/Alleesi...
Downloading Cruvu's stream to twitch_streams/Cruvu...
Subprocesses are in group with leader PID: 56234
To kill all download subprocesses (without killing the parent), run:
kill -2 -56234; sleep 2; kill -9 -56234
kill -2 -56234; sleep 2; kill -9 -56234
^CTraceback (most recent call last):
  File "/home/ubuntu/Code/twitch_detection/test/production/main.py", line 131, in <module>
    time.sleep(1)  # Check every second for better precision.
    ^^^^^^^^^^^^^
KeyboardInterrupt

ubuntu@ip-172-31-46-149:~/Code/twitch_detection/test/production$ kill -2 -56234; sleep 2; kill -9 -56234
ubuntu@ip-172-31-46-149:~/Code/twitch_detection/test/production$ 4